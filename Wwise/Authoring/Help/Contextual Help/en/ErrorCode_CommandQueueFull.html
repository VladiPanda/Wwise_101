<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Audio command queue is full, blocking caller. Reduce number of calls to sound engine or boost command queue memory.</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.2"><link rel="home" href="index.html" title="Wwise Contextual Help"><link rel="up" href="common_errors_reported_in_capture_log.html" title="Errors Reported in the Capture Log"><link rel="prev" href="ErrorCode_CommandTooLarge.html" title="Audio command is too large to fit in the command queue. Break the command in smaller pieces."><link rel="next" href="ErrorCode_ChannelConfigRequestDenied.html" title="Audio Device could not honor the channel config requested with AkOutputSettings; default config will be used."></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="sect3"><div class="titlepage"><div><div><h4 class="title">Audio command queue is full, blocking caller. Reduce number of calls to sound engine or boost command queue memory.</h4></div></div></div><p>The audio command queue is the mechanism that relays all API calls from game to the inner sound engine. It is a memory buffer that you can monitor in the Performance Monitor view. When this buffer is full of commands, it will temporarily block the game thread that is trying to add yet another command. This is done to avoid losing API calls which could later lead to synchronization issues between the game and the sound engine. However, this will likely cause a hiccup in the game framerate.</p><div class="itemizedlist"><p class="title"><b>Probable causes:</b></p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Too many API calls are made in a single game frame. This is most common reason this error is reported. Usual suspects are redundant calls to <a class="link" href="https://www.audiokinetic.com/library/edge/?source=SDK&amp;id=namespace_a_k_1_1_sound_engine_a789e25bda32d1e11849afb6584942455.html" target="_blank"> <code class="code">SetPosition</code></a>, <a class="link" href="https://www.audiokinetic.com/library/edge/?source=SDK&amp;id=class_a_k_1_1_i_ak_global_plugin_context_afd9075833fd9d0d4f3ef1b011f832fe3.html" target="_blank"> <code class="code">SetRTPCValue</code></a>, <a class="link" href="https://www.audiokinetic.com/library/edge/?source=SDK&amp;id=namespace_a_k_1_1_sound_engine_a9c9d57ba7b3af2b896e26297a7657264.html" target="_blank">
          <code class="code">SetSwitch</code></a>, and the like. This also happen while setting up a "level", creating lots of Game Objects, setting their position and RTPCs before the actual game process starts.</p></li><li class="listitem"><p>Memory intensive API calls are made, with huge numbers in the parameter arrays (such as <a class="link" href="https://www.audiokinetic.com/library/edge/?source=SDK&amp;id=ak__soundengine__setmultiplepositions.html" target="_blank"> <code class="code">SetMultiplePositions</code></a>or geometry calls for Spatial Audio).</p></li><li class="listitem"><p>The audio processing thread is very busy, preventing processing of commands. This error would be accompanied by a Voice Starvation error if that is the case.</p></li><li class="listitem"><p>The audio processing thread is blocked or deadlocked. This is indicative of a bug in either the game or Wwise itself.</p></li></ul></div><div class="itemizedlist"><p class="title"><b>Recommended resolution steps:</b></p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Profile the API calls the game is making by enabling <span class="bold"><strong>API Calls</strong></span> in the <a class="link" href="">Profiler Settings</a> (Alt-G). This can be used to identify which game process is flooding the queue with API calls.</p></li><li class="listitem"><p>Review the way the game updates the Game Syncs (States, Switches, Game Parameters) for Wwise. Update these only when necessary.</p></li><li class="listitem"><p>Add intra-game-frame calls to <a class="link" href="https://www.audiokinetic.com/library/edge/?source=SDK&amp;id=namespace_a_k_1_1_sound_engine_afe54af0f5be38be061e8a3c7d7642bb1.html" target="_blank">
          <code class="code">AK::SoundEngine::RenderAudio</code></a> to split a game frame into multiple audio frames. RenderAudio only marks the end of a collection of API calls that pertain to a game frame. It will trigger processing of the Audio command queue to update the internal sound engine state, but no actual audio is rendered by that function call.</p></li><li class="listitem"><p>Make sure the audio processing thread (named <code class="code">AK::EventMgrThread</code>, but whose priority is set via <code class="code">AkPlatformInitSettings::threadLEngine</code>) has a high enough CPU priority to process. If this was the problem, the game would also experience a lot of "Voice Starvation" errors too.</p></li><li class="listitem"><p>Connect a debugger to the game and validate that the thread named <code class="code">AK::EventMgrThread</code> is actually running. If it isn't, it would imply the game already lost all sound. If this is the case, contact Audiokinetic Support.</p></li><li class="listitem"><p>Increase command queue memory size, see <a class="link" href="https://www.audiokinetic.com/library/edge/?source=SDK&amp;id=struct_ak_init_settings_afd6ada0769c6316e7950961c38cc09d0.html#afd6ada0769c6316e7950961c38cc09d0" target="_blank">AkInitSettings::uCommandQueueSize</a> .</p></li></ul></div><div class="itemizedlist"><p class="title"><b>See also:</b></p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="https://www.audiokinetic.com/library/edge/?source=Help&amp;id=monitoring_and_troubleshooting_with_performance_monitor" target="_blank">Monitoring and Troubleshooting with the Performance Monitor</a> </p></li><li class="listitem"><p> <a class="xref" href="">???</a> </p></li></ul></div></div></body></html>
