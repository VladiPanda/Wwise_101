<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Audio command queue is full, blocking caller. Reduce number of calls to sound engine or boost command queue memory.</title><link rel="stylesheet" type="text/css" href="style_ja.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.2"><link rel="home" href="index.html" title="Wwise Contextual Help"><link rel="up" href="common_errors_reported_in_capture_log.html" title="Capture Logで報告されるエラー"><link rel="prev" href="ErrorCode_CommandTooLarge.html" title="Audio command is too large to fit in the command queue. Break the command in smaller pieces."><link rel="next" href="ErrorCode_ChannelConfigRequestDenied.html" title="Audio Device could not honor the channel config requested with AkOutputSettings; default config will be used."></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="sect3"><div class="titlepage"><div><div><h4 class="title">Audio command queue is full, blocking caller. Reduce number of calls to sound engine or boost command queue memory.</h4></div></div></div><p>オーディオコマンドキューは、ゲームから内部サウンドエンジンへの全てのAPIコールを伝達するメカニズムです。これは、Performance Monitorビューでモニタリングできるメモリバッファです。バッファがコマンドでいっぱいになると、さらにコマンドを追加しようとするゲームスレッドが一時的にブロックされます。目的は、APIコールの損失によるゲームとサウンドエンジンの同期問題を防止することです。ただし、ゲームのフレームレートが乱れる可能性が高くなります。</p><div class="itemizedlist"><p class="title"><b>考えられる原因: </b></p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>1つのゲームフレームで送信されるAPIコールが多すぎます。これが、このエラーの最も一般的な原因です。<a class="link" href="https://www.audiokinetic.com/library/edge/?source=SDK&amp;id=namespace_a_k_1_1_sound_engine_a789e25bda32d1e11849afb6584942455.html" target="_blank"> <code class="code">SetPosition</code> </a>、 <a class="link" href="https://www.audiokinetic.com/library/edge/?source=SDK&amp;id=class_a_k_1_1_i_ak_global_plugin_context_afd9075833fd9d0d4f3ef1b011f832fe3.html" target="_blank"> <code class="code">SetRTPCValue</code> </a>、 <a class="link" href="https://www.audiokinetic.com/library/edge/?source=SDK&amp;id=namespace_a_k_1_1_sound_engine_a9c9d57ba7b3af2b896e26297a7657264.html" target="_blank"> <code class="code">SetSwitch</code> </a>などへの余分なコールが理由で、よく発生するエラーです。また、ゲームで新しいレベルを展開するときに、多数のゲームオブジェクトを作成して、実際のゲームプロセスのスタート前にそれらのポジションやRTPCを設定する場合などにも、発生します。</p></li><li class="listitem"><p>大量のパラメータアレイ（ <a class="link" href="https://www.audiokinetic.com/library/edge/?source=SDK&amp;id=ak__soundengine__setmultiplepositions.html" target="_blank"> <code class="code">SetMultiplePositions</code></a>や、スペーシャルオーディオ用のジオメトリ関連コールなど）が含まれる、メモリ負荷の高い複数のAPIコールが発生しました。</p></li><li class="listitem"><p>オーディオ処理スレッドに過度の負荷がかかり、コマンド処理を阻止しています。このエラーにボイススターベーションが伴えば、Voice Starvationエラーも表示されます。</p></li><li class="listitem"><p>オーディオ処理スレッドがブロックされた、またはデッドロックが発生しました。ゲームまたはWwise自体のバグの可能性があります。</p></li></ul></div><div class="itemizedlist"><p class="title"><b>推奨される解決策: </b></p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="bold"><strong>API Calls</strong></span> を <a class="link" href="">Profiler Settings</a> （Alt-G）で有効にしてゲームが行っているAPIコールのプロファイリングを行います。これを使って、キューに大量のAPIコールを送り込んでいるゲームプロセスを特定できます。</p></li><li class="listitem"><p>ゲームがWwiseに対して、ゲームシンク（States, Switches, Game Parameters）をどのように更新しているかを、再確認します。これらの更新は、必要なときだけに行うようにします。</p></li><li class="listitem"><p> <a class="link" href="https://www.audiokinetic.com/library/edge/?source=SDK&amp;id=namespace_a_k_1_1_sound_engine_afe54af0f5be38be061e8a3c7d7642bb1.html" target="_blank"> <code class="code">AK::SoundEngine::RenderAudio</code></a> にゲームフレーム内コールを追加し、1つのゲームフレームを複数のオーディオフレームに分割します。RenderAudioは、1つのゲームフレームに属する一連のAPIコールの終了だけを認識します。内部サウンドエンジンの状況を更新するために、Audioコマンドキューの処理をトリガーしますが、このファンクションコールでレンダリングされる実際のオーディオはありません。</p></li><li class="listitem"><p>オーディオ処理スレッド（名前は <code class="code">AK::EventMgrThread</code> であるものの、プロパティは <code class="code">AkPlatformInitSettings::threadLEngine</code> 経由で設定）のCPUのプライオリティを、処理するのに充分な優先順位にします。問題がある場合は、ゲーム中に"Voice Starvation"エラーも頻繁に発生するはずです。</p></li><li class="listitem"><p>ゲームにデバッガを接続して、<code class="code">AK::EventMgrThread</code>というスレッドが実際に稼働しているかを、検証してください。稼働していない場合は、ゲームのサウンドが既に失われていることを意味します。この場合はAudiokineticサポートにご連絡ください。</p></li><li class="listitem"><p>コマンドキューのメモリサイズを、 <a class="link" href="https://www.audiokinetic.com/library/edge/?source=SDK&amp;id=struct_ak_init_settings_afd6ada0769c6316e7950961c38cc09d0.html#afd6ada0769c6316e7950961c38cc09d0" target="_blank">AkInitSettings::uCommandQueueSize</a> を参照し、拡張してください。</p></li></ul></div><div class="itemizedlist"><p class="title"><b>参考:</b></p><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p> <a class="link" href="https://www.audiokinetic.com/library/edge/?source=Help&amp;id=monitoring_and_troubleshooting_with_performance_monitor" target="_blank">Performance Monitorを使った、モニタリングとトラブルシューティング</a> </p></li><li class="listitem"><p> <a class="xref" href="">???</a> </p></li></ul></div></div></body></html>
